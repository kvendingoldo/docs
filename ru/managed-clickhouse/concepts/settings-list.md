# Настройки {{ CH }}

Для кластера {{ mch-name }} можно задать настройки, которые относятся к {{ CH }}:

   * [Настройки на уровне сервера](#server-level-settings) — задаются на уровне шарда или кластера. В пользовательской инсталляции {{ CH }} эти настройки меняются только через конфигурационные файлы, а в кластерах {{ mch-name }} — только через интерфейсы {{ yandex-cloud }}.
   * [Настройки на уровне запроса](#user-level-settings) — задаются на уровне пользователя, сессии или запроса.
   * [Настройки квот](#quota-settings) — задаются на уровне пользователя.

{% note info %}

В {{ CH }} доступно больше настроек, чем поддержано в интерфейсах {{ yandex-cloud }}. С помощью SQL-запросов можно изменить произвольные настройки {{ CH }}, в том числе [установить настройки {{ CH }} на уровне запроса](../operations/change-query-level-settings.md) или [изменить настройки таблиц MergeTree](../operations/change-server-level-settings.md#sql-queries).

{% endnote %}

Метки рядом с названием настройки позволяют определить, с помощью какого интерфейса задается значение этой настройки: консоль управления, CLI, [API](../../glossary/rest-api.md), SQL или {{ TF }}. Метка {{ tag-all }} указывает, что поддерживаются все перечисленные интерфейсы.

В зависимости от выбранного интерфейса, одна и та же настройка будет представлена по-разному, например:

- **Geobase uri** в консоли управления соответствует:
  - `geobase_uri` в gRPC API, {{ TF }};
  - `geobaseUri` в REST API;
- **Allow DDL** в консоли управления соответствует:
  - `allow_ddl` в CLI, gRPC API, SQL;
  - `allowDdl` в REST API.

## Настройки на уровне сервера {#server-level-settings}

Доступны следующие настройки:

{% include [mch-dbms-settings](../../_includes/mdb/mch-dbms-settings.md) %}

## Настройки на уровне запроса {#user-level-settings}

### Настройки СУБД {#dbms-user-settings}

Эти настройки действуют на уровне отдельного пользователя.

Доступны следующие настройки:

{% include [mch-dbms-user-settings](../../_includes/mdb/mch-dbms-user-settings.md) %}

### Пользовательские настройки {#custom-settings}

[Пользовательские настройки]({{ ch.docs }}/operations/settings/#custom_settings) можно переопределять как переменные в [профиле настроек]({{ ch.docs }}/operations/access-rights/#settings-profiles-management), сессии или запросе. Работа с профилями настроек доступна, если для кластера включено [управление пользователями через SQL](../operations/cluster-users.md#sql-user-management).

Название пользовательской настройки в {{ mch-name }} должно начинаться с предопределенного префикса `custom_`. Префикс фиксированный — пользователь не может его менять.

## Настройки квот {#quota-settings}

Квота позволяет ограничить потребление ресурсов {{ CH }} в течение заданного интервала времени. Настройки квоты задаются для отдельно взятого пользователя.

Если пользователь превысил одно из ограничений квоты, то он не сможет выполнять новые запросы до того, как истечет интервал.
{{ CH }} выведет сообщение о превышении квоты и укажет время начала нового интервала, когда запрет на выполнение запросов будет снят, а счетчики ограничений — сброшены.

{{ CH }} также использует квоты для учета потребления ресурсов.
Для каждого пользователя есть квота по умолчанию, которая учитывает потребление всех ресурсов за каждый час, но не накладывает никаких ограничений.
Сведения об уровне потребления ресурсов записываются в лог сервера {{ CH }}.

Подробнее см. в [документации {{ CH }}]({{ ch.docs }}/operations/quotas/).

Доступны следующие настройки квот:

{% include [mch-quota-user-settings](../../_includes/mdb/mch-quota-user-settings.md) %}

{% include [clickhouse-disclaimer](../../_includes/clickhouse-disclaimer.md) %}
