# Как добавлять и изменять SSH-ключи пользователей Linux на хостах группы узлов {{ managed-k8s-name }}


## Описание задачи {#case-description}

* Необходимо добавить нового пользователя Linux на хосты группы узлов кластера {{ managed-k8s-name }};
* Необходимо обновить SSH-ключ существующего пользователя Linux на хостах группы узлов кластера {{ managed-k8s-name }}.

## Решение {#case-resolution}

Для добавления нового пользователя или обновления SSH-ключа для текущего пользователя следует обновить ключи группы узлов. Перед запуском этой операции следует подготовить файл с SSH-ключами для пользователей и привести его к следующему виду:

```
username:ssh-ed25519 AAAAB3NzaCXXXXXXXXXXXzo/lP1ww== username
username2:ssh-ed25519 ONEMOREkeyXXXXXXXXXXX88OavEHw== username2
```

Затем с помощью YC CLI нужно выполнить команду:

```
yc managed-kubernetes node-group add-metadata \
  --name <наименование_группы_узлов> \
  --metadata-from-file ssh-keys=<путь_к_файлу_с_публичными_ssh_ключами>
```
В результате выполнения этой команды в группе узлов кластера будут выполнены следующие операции:

* SSH-ключи существующих пользователей будут обновлены на новые;
* Ранее не существовавшие пользователи будут созданы с указанными SSH-ключами.

При обновлении SSH-ключей группа узлов перейдет в состояние `RECONCILING`, поскольку на виртуальных машинах в этой группе запустится операция обновления метаданных.

{% note alert %}

Запуск операции обновления метаданных для группы узлов кластера {{ managed-k8s-name }} может привести к частичной или полной недоступности узлов в затронутой группе на срок до 20 минут.

{% endnote %}